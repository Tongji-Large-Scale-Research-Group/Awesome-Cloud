# Awesome-Cloud 周刊（第 9 期）：基础概念-多调度器调度系统

这里简单记录每周分享的前沿内容，不定期发布。

---


## 📚 内容目录
1. 背景介绍
2. 集中式调度系统
3. 两层调度系统
4. 共享状态调度系统
5. 总结与典型案例
6. 问答记录

---

## 🧠 背景介绍
调度器泛指用于分配资源与管理任务执行的系统，常见类型包括：
- 批处理调度系统（如早期计算机）
- 抢占式进程调度、内存管理（如现代操作系统）
- 定时调度工具（如 `crontab`、Quartz）
- 编程语言 Runtime 中的线程/协程调度器（如 Golang 的 Goroutine）
- 分布式任务调度系统（如 Hadoop YARN、Airflow）
- 资源调度系统（如 Mesos、Borg、Kubernetes）

**挑战背景：**
随着集群规模扩展与工作负载多样化，如何提升调度效率、系统吞吐量与资源利用率成为核心挑战。

---

## 🧭 集中式调度系统（Centralized Scheduler）
调度器在集群中为单点实体，统一管理所有资源请求与任务调度。

### 特点：
- 适合运行时间长、吞吐量大的任务
- 调度算法不可扩展，灵活性差
- 状态同步简单，稳定性好
- 存在单点故障风险，容错性弱
- 可扩展性差，成为系统瓶颈

### 📌 案例：Hadoop YARN
- **ResourceManager** 管理资源状态与任务监控
- **NodeManager** 管理本地资源和任务状态
- **Container** 是任务运行与资源分配的基本单元

---

## 🏗️ 两层调度系统（Two-Level Scheduler）
为缓解集中式瓶颈，系统采用分区调度，资源管理分为中央与局部两层。

### 特点：
- 分区调度器处理局部资源与任务
- 中央调度器处理资源分配与无法满足的任务请求
- 增强灵活性与可扩展性
- 单点失败影响小
- 状态同步难度提升

### 📌 案例：Mesos
- **Mesos Master** 管理全局资源
- **Mesos Agent** 运行在节点上管理资源与任务
- **Framework** 接收资源 Offer，自主调度任务，无需 Master 干预

---

## 🔄 共享状态调度系统（Shared-State Scheduler）
为解决状态一致性与可扩展性问题，将调度器拆分为多个服务共享状态。

### 特点：
- 核心只维护集群资源状态
- 各调度服务独立运行，使用 API 读写状态
- 状态一致性由系统机制保证
- 高扩展性与灵活性

### 📌 案例 1：Borg / Kubernetes
- 资源管理由 BorgMaster 统一维护
- 各 Scheduler 自主运行，定期同步状态，通过 API 执行调度决策

### 📌 案例 2：Omega
- 使用事务管理资源调度与状态同步
- 提供死锁检测与乐观锁机制
- 设计复杂度高，实用性受限

---

## ✅ 总结
| 类型 | 优势 | 劣势 |
|------|------|------|
| **集中式** | 状态一致性好、实现简单 | 容错性差、扩展性弱 |
| **两层式** | 灵活性高、分区管理 | 状态同步困难 |
| **共享状态** | 可扩展性高、容错好 | 实现复杂、需要强一致性机制 |

---

## ❓ 问答记录

**Q1: 为什么集中式调度器可扩展性差？**  
A: 所有资源与任务请求都需经过中央调度器，易成为瓶颈，无法横向扩展。

**Q2: 两层调度系统如何提高可用性？**  
A: 每个分区可独立调度与运行任务，避免单点失败导致系统整体崩溃。

**Q3: Kubernetes 属于哪类调度架构？**  
A: 属于共享状态调度架构，具有高可用与灵活性，状态通过 API 同步。

**Q4: Omega 系统的优势与劣势是什么？**  
A: 优势在于支持事务调度与死锁检测；劣势是实现复杂，实际推广有限。

---

